<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Leo&#39;s notepad</title>
  
  <subtitle>yet another blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://leowll.com/"/>
  <updated>2020-11-27T00:41:48.000Z</updated>
  <id>http://leowll.com/</id>
  
  <author>
    <name>Leo Wang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>How to update PandoraBox via ssh 通过SSH升级旧版本PandoraBox</title>
    <link href="http://leowll.com/2020/11/26/20201127%20how%20to%20update%20pandorabox%20via%20ssh/"/>
    <id>http://leowll.com/2020/11/26/20201127 how to update pandorabox via ssh/</id>
    <published>2020-11-27T00:33:00.000Z</published>
    <updated>2020-11-27T00:41:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下升级PandoraBox差点变砖，却成功挽救的经历。</p><h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>之前通过刷机把自家的小米路由器3Pro升级到了PandoraBox系统。<br>之后就一直放着没有用，后来偶然的机会发现PandoraBox升级了好几个版本，就想着把自己的路由器也升级一下。</p><h1 id="第一次升级"><a href="#第一次升级" class="headerlink" title="第一次升级"></a>第一次升级</h1><p>本以为通过Pandorabox系统自带的升级功能，选择固件更新，再上传system upgrade文件就可以了，结果直接变半砖。<br>升级完之后无线不可用，指示灯闪烁。还想着再刷回R3P自带的系统，结果也不成功。<br>好像第一次升级成PandoraBox之后就无法回退到厂家自带的系统了。至于原理自己不了解，有懂的朋友请赐教。</p><h1 id="第二次升级"><a href="#第二次升级" class="headerlink" title="第二次升级"></a>第二次升级</h1><p>就在一筹莫展的时候，想起来路由器可以通过网线连接，结果连上之后，ssh竟然连上了。<br>系统的密码是root/admin.</p><p>接下来跟着网上的教程照猫画虎，因为ssh可用，所以通过wscp软件将需要升级的系统文件上传到路由器的/tmp文件夹中。<br>接下来通过执行以下命令，顺利实现了升级!</p><p><code>mtd -r write /tmp/XXX.img Bootloader</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;记录一下升级PandoraBox差点变砖，却成功挽救的经历。&lt;/p&gt;
&lt;h1 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h1&gt;&lt;p&gt;之前通过刷机把自家的小米路由器3Pro升级到了PandoraBo
      
    
    </summary>
    
    
      <category term="PandoraBox" scheme="http://leowll.com/tags/PandoraBox/"/>
    
      <category term="Xiaomi R3P" scheme="http://leowll.com/tags/Xiaomi-R3P/"/>
    
      <category term="小米路由器3 Pro" scheme="http://leowll.com/tags/%E5%B0%8F%E7%B1%B3%E8%B7%AF%E7%94%B1%E5%99%A83-Pro/"/>
    
  </entry>
  
  <entry>
    <title>How to include jQuery into Vue without npm install</title>
    <link href="http://leowll.com/2020/05/31/20200601%20how%20to%20include%20jQuery%20into%20Vue%20without%20npm/"/>
    <id>http://leowll.com/2020/05/31/20200601 how to include jQuery into Vue without npm/</id>
    <published>2020-05-31T23:33:00.000Z</published>
    <updated>2020-05-31T23:33:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>在Vue程序中，有时需要引入jQuery，比如你习惯了用$.ajax来进行网络请求，或者进行一些控件操作。<br>可以通过加载jQuery的module来实现:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jquery --save</span><br></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">'jquery'</span></span><br></pre></td></tr></table></figure><p>但问题是这样编译出来的结果会更大，从而造成一些性能问题。</p><p>可以简单地通过在index.html中直接引入jQuery的链接来使用jQuery，但是编译的时候又会报错。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.5.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>编译的错误如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uncaught ReferenceError: jQuery is not defined</span><br></pre></td></tr></table></figure></p><p>怎么解决这个错误呢，通过配置eslint来解决！</p><p>eslint在Vue中被用来检测程序是否有一些不规范的写法，通过让eslint来识别jQuery，就可以来规避编译时的报错了。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">"eslintConfig": &#123;</span><br><span class="line">  "root": true,</span><br><span class="line">  "env": &#123;</span><br><span class="line">    "node": true</span><br><span class="line">  &#125;,</span><br><span class="line">  "extends": [</span><br><span class="line">    "plugin:vue/essential",</span><br><span class="line">    <span class="string">"eslint:recommended"</span></span><br><span class="line">  ],</span><br><span class="line">  "parserOptions": &#123;</span><br><span class="line">    "parser": "babel-eslint"</span><br><span class="line">  &#125;,</span><br><span class="line">  "rules": &#123;&#125;,</span><br><span class="line">  "globals": &#123;</span><br><span class="line">    "$": true,</span><br><span class="line">    "jQuery": true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>“globals”的部分的定义：</p><blockquote><p>Globals - 脚本在执行期间访问的额外的全局变量。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在Vue程序中，有时需要引入jQuery，比如你习惯了用$.ajax来进行网络请求，或者进行一些控件操作。&lt;br&gt;可以通过加载jQuery的module来实现:&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;
      
    
    </summary>
    
    
      <category term="Vue" scheme="http://leowll.com/tags/Vue/"/>
    
      <category term="jQuery" scheme="http://leowll.com/tags/jQuery/"/>
    
      <category term="eslint" scheme="http://leowll.com/tags/eslint/"/>
    
  </entry>
  
  <entry>
    <title>How to display OData json date in SAPUI5 view</title>
    <link href="http://leowll.com/2020/05/01/20200501%20how%20to%20display%20json%20date%20in%20sapui5/"/>
    <id>http://leowll.com/2020/05/01/20200501 how to display json date in sapui5/</id>
    <published>2020-05-01T04:17:00.000Z</published>
    <updated>2020-05-02T09:08:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>OData的日期类型无法原样显示在SAPUI5的页面上，怎样解决这一问题。</p><ol><li>Date String Received from OData.<br>Date string from OData Service is like below:<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"SalesOrderDate": "/Date(1587945600000)/",</span><br></pre></td></tr></table></figure></li></ol><p>这样的数据无法直接显示在SAPUI5的View里面。<br>即便你设置data type为日期类型，也是无法直接识别的。</p><ol start="2"><li>Create your date formatter.</li></ol><p>在View的Controller里创建自己的formatter,然后在View中进行相应的设置。<br>JS代码中用到了正规法则，识别一段字符串中的数字，然后将这一串数字作为timestamp来生成一个Date类型的变量，<br>再通过sap.ui.core.format.DateFormat来设置格式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sap.ui.define([</span><br><span class="line"><span class="string">"sap/ui/core/mvc/Controller"</span>,</span><br><span class="line"><span class="string">"sap/ui/core/format/DateFormat"</span></span><br><span class="line">], <span class="function"><span class="keyword">function</span> (<span class="params">Controller,DateFormat</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">formatJSONDate: <span class="function"><span class="keyword">function</span>(<span class="params">sDate</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> oDateFormat = DateFormat.getDateTimeInstance(&#123;</span><br><span class="line">style: <span class="string">"short"</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(sDate.match(<span class="regexp">/\d+/</span>)[<span class="number">0</span>] * <span class="number">1</span>); </span><br><span class="line"><span class="keyword">return</span> oDateFormat.format(d,<span class="literal">true</span>); <span class="comment">//true for UTC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>Use your formatter in your view.<br>View中对UI控件设置formatter<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">text</span>=<span class="string">"&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">path: '/Date',</span></span></span><br><span class="line"><span class="tag"><span class="string">formatter: '.formatJSONDate'</span></span></span><br><span class="line"><span class="tag"><span class="string">&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;OData的日期类型无法原样显示在SAPUI5的页面上，怎样解决这一问题。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Date String Received from OData.&lt;br&gt;Date string from OData Service is like below:&lt;figu
      
    
    </summary>
    
    
      <category term="SAPUI5" scheme="http://leowll.com/tags/SAPUI5/"/>
    
      <category term="SAP" scheme="http://leowll.com/tags/SAP/"/>
    
      <category term="json" scheme="http://leowll.com/tags/json/"/>
    
      <category term="OData" scheme="http://leowll.com/tags/OData/"/>
    
  </entry>
  
  <entry>
    <title>How to use jar in SCPI (SAP Cloud Platform Integration)</title>
    <link href="http://leowll.com/2020/04/07/20200407_how%20to%20use%20jar%20in%20SCPI/"/>
    <id>http://leowll.com/2020/04/07/20200407_how to use jar in SCPI/</id>
    <published>2020-04-07T07:30:00.000Z</published>
    <updated>2020-04-07T07:40:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="怎样在SCPI中引入Jar文件"><a href="#怎样在SCPI中引入Jar文件" class="headerlink" title="怎样在SCPI中引入Jar文件?"></a>怎样在SCPI中引入Jar文件?</h1><p>在SCPI里可以通过创建Groovy Script来对数据进行一些处理，比如解析csv文件并处理里面的数据。<br>当然我们可以自己写代码来解析csv文件，但通常是重复造轮子。</p><p>因为这个世界上已经存在着很多优秀程序员写好的类库，我们只需要在自己的程序中调用一下就可以了，没必要重复造轮子。</p><p>SCPI中也支持引入外部的jar文件，以CSV文件的解析为例，为了能在程序中使用groovycsv这个库，我们需要引入以下两个jar文件：</p><ul><li>groovycsv-1.3</li><li>opencsv-3.8</li></ul><h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><p>下面解释一下怎样在SCPI的Flow里面引入jar文件</p><ol><li>进入Flow的编辑模式。</li></ol><p><img src="https://s1.ax1x.com/2020/04/07/GgAbMn.png" alt="edit flow" width="50%"></p><ol start="2"><li>编辑模式下，在Flow的Resources设置Tab添加Jar文件。</li></ol><p><img src="https://s1.ax1x.com/2020/04/07/GgALq0.png" alt="add jar" width="50%"></p><ol start="3"><li>添加之后的结果：</li></ol><p><img src="https://s1.ax1x.com/2020/04/07/GgAXZV.png" alt="result" width="50%"></p><ol start="4"><li>在Groovy Script中引入自己需要的类。</li></ol><p><img src="https://s1.ax1x.com/2020/04/07/GgAoGQ.png" alt="script" width="50%"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;怎样在SCPI中引入Jar文件&quot;&gt;&lt;a href=&quot;#怎样在SCPI中引入Jar文件&quot; class=&quot;headerlink&quot; title=&quot;怎样在SCPI中引入Jar文件?&quot;&gt;&lt;/a&gt;怎样在SCPI中引入Jar文件?&lt;/h1&gt;&lt;p&gt;在SCPI里可以通过创建Groo
      
    
    </summary>
    
    
      <category term="SAP" scheme="http://leowll.com/tags/SAP/"/>
    
      <category term="SCPI" scheme="http://leowll.com/tags/SCPI/"/>
    
      <category term="SAP Cloud Platform Integration" scheme="http://leowll.com/tags/SAP-Cloud-Platform-Integration/"/>
    
      <category term="groovy" scheme="http://leowll.com/tags/groovy/"/>
    
  </entry>
  
  <entry>
    <title>Spring Batch执行异步Job的方法</title>
    <link href="http://leowll.com/2019/09/03/20190903-spring-batch-async-job/"/>
    <id>http://leowll.com/2019/09/03/20190903-spring-batch-async-job/</id>
    <published>2019-09-03T04:33:00.000Z</published>
    <updated>2019-09-04T04:33:32.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>Spring Batch默认的JobLauncher执行Job的方式是同步的。<br>如果需要执行异步Job，则需要定义能执行异步Job的JobLauncher。</p><h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><ol><li><p>在Configuration Class中定义SimpleJobLauncher, 设置其TaskExecutor为异步的SimpleAsyncTaskExecutor</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableBatchProcessing</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BatchConfiguration</span> </span>&#123;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleJobLauncher <span class="title">simpleJobLauncher</span><span class="params">(JobRepository jobRepository)</span></span>&#123;</span><br><span class="line">    SimpleJobLauncher jobLauncher = <span class="keyword">new</span> SimpleJobLauncher();</span><br><span class="line">    jobLauncher.setJobRepository(jobRepository);</span><br><span class="line">    jobLauncher.setTaskExecutor(<span class="keyword">new</span> SimpleAsyncTaskExecutor());</span><br><span class="line">    <span class="keyword">return</span> jobLauncher;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在调用Launcher的主程序中设置自动注入，就可以使用了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">SimpleJobLauncher simpleJobLauncher;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">Job job1;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">Job jo2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(ApplicationArguments args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">logger.info(<span class="string">"##### run async jobs #####"</span>);</span><br><span class="line">simpleJobLauncher.run(job1, jobParameters);</span><br><span class="line">simpleJobLauncher.run(job2, jobParameters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;Spring Batch默认的JobLauncher执行Job的方式是同步的。&lt;br&gt;如果需要执行异步Job，则需要定义能执行异步Job的J
      
    
    </summary>
    
    
      <category term="Spring Boot" scheme="http://leowll.com/tags/Spring-Boot/"/>
    
      <category term="Spring Batch" scheme="http://leowll.com/tags/Spring-Batch/"/>
    
      <category term="Async" scheme="http://leowll.com/tags/Async/"/>
    
  </entry>
  
  <entry>
    <title>Gradle排除war中特定依赖的方法</title>
    <link href="http://leowll.com/2019/05/29/20190529-gradle-exclude-war/"/>
    <id>http://leowll.com/2019/05/29/20190529-gradle-exclude-war/</id>
    <published>2019-05-29T05:29:50.000Z</published>
    <updated>2019-05-29T05:29:47.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>在往SAP Cloud Platform Neo上部署war文件后，有时会出现程序无法启动的错误。<br>通过排查错误日志，发现log中有类似下面的描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2019 05 28 09:31:00#+00#ERROR#org.slf4j.helpers.Util##anonymous#localhost-startStop-1#na#xxxx#sampleapp#web##na#na#na#na#SLF4J: Class path contains multiple SLF4J bindings. |</span><br><span class="line">2019 05 28 09:31:00#+00#ERROR#org.slf4j.helpers.Util##anonymous#localhost-startStop-1#na#xxxx#sampleapp#web##na#na#na#na#SLF4J: Found binding in [jar:file:/usr/sap/ljs/bin/logback-classic.jar!/org/slf4j/impl/StaticLoggerBinder.class] |</span><br><span class="line">2019 05 28 09:31:00#+00#ERROR#org.slf4j.helpers.Util##anonymous#localhost-startStop-1#na#xxxx#sampleapp#web##na#na#na#na#SLF4J: Found binding in [jar:file:/usr/sap/ljs/webapps/spring-boot-Olingo-oData-master/WEB-INF/lib/logback-classic-1.1.2.jar!/org/slf4j/impl/StaticLoggerBinder.class] |</span><br><span class="line">2019 05 28 09:31:00#+00#ERROR#org.slf4j.helpers.Util##anonymous#localhost-startStop-1#na#xxxx#sampleapp#web##na#na#na#na#SLF4J: See http://www.slf4j.org/codes.html\#multiple_bindings for an explanation. |</span><br><span class="line">2019 05 28 09:31:00#+00#ERROR#org.slf4j.helpers.Util##anonymous#localhost-startStop-1#na#xxxx#sampleapp#web##na#na#na#na#SLF4J: Actual binding is of type [ch.qos.logback.classic.util.ContextSelectorStaticBinder]</span><br></pre></td></tr></table></figure></p><p>仔细观察发现该错误是slf4j和logback的依赖冲突导致的。</p><h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><p>通过参考<a href="http://www.zhyea.com/2018/02/08/gradle-exclude-dependencies.html" target="_blank" rel="noopener">gradle-exclude-dependencies</a>这篇文章，尝试了如下解决办法：</p><h2 id="Dependency局部排除"><a href="#Dependency局部排除" class="headerlink" title="Dependency局部排除"></a>Dependency局部排除</h2><p>通过对spring boot的依赖添加exclude描述来排除特定依赖。<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">compile</span>(<span class="string">"org.springframework.boot:spring-boot-starter-web:$&#123;project.bootVersion&#125;"</span>)&#123;</span><br><span class="line"><span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'org.slf4j'</span>, module: <span class="string">'slf4j-api'</span></span><br><span class="line"><span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'ch.qos.logback'</span>, module: <span class="string">'logback-classic'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">compile</span>(<span class="string">"org.springframework.boot:spring-boot-starter-actuator:$&#123;project.bootVersion&#125;"</span>)&#123;</span><br><span class="line"><span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'org.slf4j'</span>, module: <span class="string">'slf4j-api'</span></span><br><span class="line"><span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'ch.qos.logback'</span>, module: <span class="string">'logback-classic'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Configuration全局排除"><a href="#Configuration全局排除" class="headerlink" title="Configuration全局排除"></a>Configuration全局排除</h2><p>在全局配置中通通排除相关依赖。<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">configurations</span> &#123;</span><br><span class="line">all*.<span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'org.slf4j'</span>, module: <span class="string">'slf4j-api'</span></span><br><span class="line">all*.<span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'ch.qos.logback'</span>, module: <span class="string">'logback-classic'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="providedRuntime打包时排除"><a href="#providedRuntime打包时排除" class="headerlink" title="providedRuntime打包时排除"></a>providedRuntime打包时排除</h2><p>上述两种方法能够解决问题，但是本地执行的时候却会报错，原因是Tomcat Embedded还是需要被排除的那些依赖。<br>怎样让gradle打包的时候排除这些依赖呢？gradle提供了providedRuntime和providedCompile等写法。<br><a href="https://docs.gradle.org/current/userguide/war_plugin.html" target="_blank" rel="noopener">The War Plugin</a><br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">providedRuntime(<span class="string">"org.slf4j:slf4j-api"</span>)</span><br><span class="line">providedRuntime(<span class="string">"ch.qos.logback:logback-classic"</span>)</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;在往SAP Cloud Platform Neo上部署war文件后，有时会出现程序无法启动的错误。&lt;br&gt;通过排查错误日志，发现log中有类
      
    
    </summary>
    
    
      <category term="Gradle" scheme="http://leowll.com/tags/Gradle/"/>
    
      <category term="war" scheme="http://leowll.com/tags/war/"/>
    
      <category term="Spring Boot" scheme="http://leowll.com/tags/Spring-Boot/"/>
    
      <category term="SAP Cloud Platform" scheme="http://leowll.com/tags/SAP-Cloud-Platform/"/>
    
  </entry>
  
  <entry>
    <title>让你的小米手机能在日本使用</title>
    <link href="http://leowll.com/2018/08/20/20180820-mi-note3-kddi-au/"/>
    <id>http://leowll.com/2018/08/20/20180820-mi-note3-kddi-au/</id>
    <published>2018-08-20T12:54:50.000Z</published>
    <updated>2020-04-07T07:12:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>有些朋友没有兴趣看我这啰嗦的记录可以直接跳到解决方案那一节。</p><h1 id="小米的手机能不能在日本用？"><a href="#小米的手机能不能在日本用？" class="headerlink" title="小米的手机能不能在日本用？"></a>小米的手机能不能在日本用？</h1><p>之前给老婆买了一台小米的Note3，办的是日本乐天（Rakuten Mobile）的格安SIM卡，装上之后时不时的断网。老婆一怒之下把手机扔给我说“难用死了，我要换手机！”</p><p><img src="https://www.jiuwa.net/tuku/20170518/YIdH0tHF.jpg" alt=""></p><p>然后就去日本的Yodabashi Camera办了UQ Mobile的SIM卡，还送了一台华为P10 Lite。UQ Mobile的速度比我Line Mobile的卡不知道快了多少。<br>Line Mobile 在2017年初的时候速度还挺快，后来慢慢的用的人多了？速度就降了下来，用Speedtest测的话只能达到2Mbps左右的网速。而老婆的手机却能测得20Mbps，让人眼馋。</p><p>我之前也是用的乐天，后来改用了Line Mobile。小米Note3貌似对日本的服务商支持不太好，我接过来之后装上也是时不时的断网。解决办法就是断网的时候就切换一下APN。看老婆的手机用的那么舒爽，于是决定也换成UQ Mobile，心想大不了也想原来一样上不了网的时候就切换一下APN嘛。</p><h1 id="事与愿违"><a href="#事与愿违" class="headerlink" title="事与愿违"></a>事与愿违</h1><p>事实是我想的太简单了。刚开始装上SIM卡的时候，走出Yodobashi的大楼就不能用了，后来回到家里能用了一段时间，但是在上班路上电车里却总也连不上信号。就这样无信号的过了一整天。后来干脆显示为SIM卡无法识别。。。</p><h1 id="折腾"><a href="#折腾" class="headerlink" title="折腾"></a>折腾</h1><p>因为一直显示不在服务区（SIM卡无法识别），我先回尝试了下面几种方法：</p><h2 id="刷机"><a href="#刷机" class="headerlink" title="刷机"></a>刷机</h2><p>刷了MIUI9的国际版，测试不通过<br>刷了MIUI10，测试不通过</p><h2 id="改基带"><a href="#改基带" class="headerlink" title="改基带"></a>改基带</h2><p>网上说日本和中国的运营商提供的基带不同，所以我在想是不是基带的问题。<br>UQ Mobile利用的是KDDI AU的线路，AU支持的LTE基带为<a href="https://www.frequencycheck.com/carriers/kddi-au-japan" target="_blank" rel="noopener">B1,B11,B18,B41</a><br>小米Note3<a href="https://www.mi.com/minote3/specs/" target="_blank" rel="noopener">支持的基带</a>为</p><ul><li>FDD-LTE (频段 B1，B3，B5，B7，B8)</li><li>TDD-LTE (频段 B34, B38，B39, B40, B41)</li><li>TD-SCDMA (频段 B34，B39)</li><li>WCDMA (频段 B1，B2，B5，B8)</li><li>GSM (频段 B2，B3，B5，B8)</li><li>CDMA1X/EVDO (频段 BC0)</li></ul><p>所以应该不是问题。</p><p>但还是想<a href="https://gadget.hrksv.com/2017/01/05/post-858" target="_blank" rel="noopener">通过QTool</a> 来改一下基带。</p><p>结果还是不行。因为我买的是小米全网通版的Note3，默认已经支持了。</p><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>踏破铁鞋无觅处，得来全不费工夫。折腾到晚上1点，终于找到了解决方法。<br>这篇<a href="https://mymobile-wifi.com/xiaomi-mi-mix-2-cdma-lte" target="_blank" rel="noopener">日本人写的博客</a> 里提到了非常简单的解决方法：</p><h2 id="0-先确认一下自己有没有添加自己家运营商的APN"><a href="#0-先确认一下自己有没有添加自己家运营商的APN" class="headerlink" title="0. 先确认一下自己有没有添加自己家运营商的APN"></a>0. 先确认一下自己有没有添加自己家运营商的APN</h2><p>很多朋友说为什么我用了你的方法不管用，不显示信号。希望先确认一下这一步有没有做。<br>各自去自己用的SIM卡家的网站上看APN怎么设置，这里就不再赘述了。</p><h2 id="1-添加VoLTE的APN"><a href="#1-添加VoLTE的APN" class="headerlink" title="1. 添加VoLTE的APN"></a>1. 添加VoLTE的APN</h2><ul><li>NAME: ims</li><li>APN: ims</li><li>MCC: 440</li><li>MNC: 51</li><li>TYPE: ims</li></ul><p>这一步很多朋友添加ims的apn之后不显示，没有关系，能用就行。</p><h2 id="2-将VoLTE的设备检测关掉"><a href="#2-将VoLTE的设备检测关掉" class="headerlink" title="2. 将VoLTE的设备检测关掉"></a>2. 将VoLTE的设备检测关掉</h2><p>通过电话拨打<code>*#*#86583#*#*</code>来关掉手机的VoLTE设备检测功能。<br>拨号后带有“…disabled”的消息一闪而过，这时你在观察手机右上角的服务商标志就显示为有信号了！</p><p><img src="https://s1.ax1x.com/2018/08/21/P48BDg.md.jpg" width="50%"></p><p>而这时你再到”设置-&gt;双卡和移动网络”中查看SIM卡信息就会发现连VoLTE高清通话功能都可用了！</p><p><img src="https://s1.ax1x.com/2018/08/21/P48DbQ.md.jpg" width="50%"></p><p>现在来测一下速度吧：</p><p><img src="https://s1.ax1x.com/2018/08/21/P48n9x.md.jpg" width="50%"></p><p>LTE速度36+Mbps，还不错！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;有些朋友没有兴趣看我这啰嗦的记录可以直接跳到解决方案那一节。&lt;/p&gt;
&lt;h1 id=&quot;小米的手机能不能在日本用？&quot;&gt;&lt;a href=&quot;#小米
      
    
    </summary>
    
    
      <category term="kddi au" scheme="http://leowll.com/tags/kddi-au/"/>
    
      <category term="mi note3" scheme="http://leowll.com/tags/mi-note3/"/>
    
      <category term="xiaomi" scheme="http://leowll.com/tags/xiaomi/"/>
    
      <category term="uq mobile" scheme="http://leowll.com/tags/uq-mobile/"/>
    
  </entry>
  
  <entry>
    <title>How to deploy spring boot application to sap cloud platform neo</title>
    <link href="http://leowll.com/2018/06/29/deploy-spring-boot-sap-cloud-platform-neo/"/>
    <id>http://leowll.com/2018/06/29/deploy-spring-boot-sap-cloud-platform-neo/</id>
    <published>2018-06-30T02:59:00.000Z</published>
    <updated>2018-06-30T16:24:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="普通Spring-Boot程序的部署"><a href="#普通Spring-Boot程序的部署" class="headerlink" title="普通Spring Boot程序的部署"></a>普通Spring Boot程序的部署</h1><p>传统的spring boot web程序，其pom.xml和main函数所在的class通常是这样的。<br>以spring boot guide提到的程序为例,通常只需要在pom中这样写就可以让程序正常执行了<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>Spring Boot自带的tomcat容器，可以让程序无需依赖外面的容器，实现更好与外部环境的松耦合。<br>在诸如cloud foundry之类的环境里可以无障碍运行，但是在sap cloud platform neo环境中，<br>部署后的程序却总是无法正常运行，显示为404 not found。</p><h1 id="怎样将Spring-Boot程序部署在Neo上"><a href="#怎样将Spring-Boot程序部署在Neo上" class="headerlink" title="怎样将Spring Boot程序部署在Neo上"></a>怎样将Spring Boot程序部署在Neo上</h1><p>查来查去在网上找到了sap自己给出的sample，比对了半天发现问题出在pom.xml和main函数的写法上。<br><a href="https://www.sap.com/developer/tutorials/spring-boot-getting-started.html" target="_blank" rel="noopener">spring-boot-getting-started</a></p><p>SAP给出的guide上明确的写着，</p><ol><li>pom.xml要写成这样：</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- developer tools for hot code-replacement etc. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Embedded tomcat etc. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为SAP Cloud Platform的Neo环境中内置了Tomcat容器，所以当部署到Neo上去的时候，你的程序就不应该再内嵌tomcat了。</p><p>tomcat使用部署环境提供的tomcat，写成<strong>provided</strong>。而且Neo中也内置了<strong>logging</strong>的库，所以相应的依赖也应该写成<strong>provided</strong>。</p><ol start="2"><li>main函数要写成这样：</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.EnableAutoConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.support.SpringBootServletInitializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder application)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> application.sources(Application.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">     SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p>通过查看官方的文档，明白了为什么main函数要写成上面的样子。<br><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-traditional-deployment.html" target="_blank" rel="noopener">How to traditional-deployment</a><br>官方文档中提到，</p><blockquote><p>The first step in producing a deployable war file is to provide a SpringBootServletInitializer subclass and override its configure method. Doing so makes use of Spring Framework’s Servlet 3.0 support and lets you configure your application when it is launched by the servlet container. Typically, you should update your application’s main class to extend SpringBootServletInitializer.</p></blockquote><p>翻译成中文就是，如果你想让你的程序运行在servlet容器（比如Neo中内嵌的Tomcat），你就需要让你的main函数继承<code>SpringBootServletInitializer</code>并重写其中的<code>configure</code>方法。<br>普通的Spring Boot程序不需要这么写，是因为它们不需要运行在外置的servlet容器中。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;普通Spring-Boot程序的部署&quot;&gt;&lt;a href=&quot;#普通Spring-Boot程序的部署&quot; class=&quot;headerlink&quot; title=&quot;普通Spring Boot程序的部署&quot;&gt;&lt;/a&gt;普通Spring Boot程序的部署&lt;/h1&gt;&lt;p&gt;传统的spr
      
    
    </summary>
    
    
      <category term="spring boot" scheme="http://leowll.com/tags/spring-boot/"/>
    
      <category term="sap cloud platform" scheme="http://leowll.com/tags/sap-cloud-platform/"/>
    
      <category term="neo" scheme="http://leowll.com/tags/neo/"/>
    
  </entry>
  
  <entry>
    <title>为Pandorabox/openwrt/lede配置花生壳DDNS</title>
    <link href="http://leowll.com/2018/06/09/config-pandorabox-oray-ddns/"/>
    <id>http://leowll.com/2018/06/09/config-pandorabox-oray-ddns/</id>
    <published>2018-06-09T10:07:00.000Z</published>
    <updated>2018-06-11T05:22:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>如果你在自己的Pandorabox/openwrt/lede上安装了aria2,你或许希望在外网能够访问自己家的服务器，这时候就要用到ddns。</p><p>花生壳提供的壳域名，历史悠久，便宜好用。<br>注册了花生壳域名之后，这篇文章教你怎样给自己的路由器设置DDNS。</p><h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>你家的路由器有公网的ip地址。有些家庭只有内网IP，没办法，联系电信运营商让他们给你开通吧。比如说你家要装个监控摄像头之类的。</p><h1 id="设置花生壳域名"><a href="#设置花生壳域名" class="headerlink" title="设置花生壳域名"></a>设置花生壳域名</h1><p>首先通过访问 <a href="http://ipinfo.io" target="_blank" rel="noopener">http://ipinfo.io</a> 这个网站，来获取自己路由器当前的ip地址。</p><p>获取了ip地址以后，在壳域名的设置页面</p><ol><li>打开花生壳设置</li><li>测试 http://[USERNAME]:[PASSWORD]@ddns.oray.com/ph/update?hostname=[DOMAIN]&amp;myip=[IP]<br>把Username，Password，DOMAIN和IP替换成自己的用户名密码，域名和IP，测试一下能否更新。</li></ol><p>有些情况下花生壳给的域名无法正常更新，原因不明。只能选择能够更新的来用了。</p><p><a href="https://imgchr.com/i/CbX3PU" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/CbX3PU.md.jpg" alt="CbX3PU.md.jpg"></a></p><h1 id="设置动态DNS"><a href="#设置动态DNS" class="headerlink" title="设置动态DNS"></a>设置动态DNS</h1><p>在Pandorabox的管理界面的服务&gt;动态DNS中进行下面的设置。<br>Pandorabox自带了Oray的服务选项，也可以自定义URL</p><ul><li>自定义更新URL:http://[USERNAME]:[PASSWORD]@ddns.oray.com/ph/update?hostname=[DOMAIN]&amp;myip=[IP]<br><a href="https://imgchr.com/i/CbXl5T" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/CbXl5T.md.jpg" alt="CbXl5T.md.jpg"></a></li></ul><p>IP地址来源选择Oray提供的URL来确认本机的IP地址。</p><ul><li>用于检测的URL：<a href="http://ddns.oray.com/checkip" target="_blank" rel="noopener">http://ddns.oray.com/checkip</a></li></ul><p><a href="https://imgchr.com/i/CbXJxJ" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/CbXJxJ.md.png" alt="CbXJxJ.md.png"></a></p><h1 id="设置Web服务"><a href="#设置Web服务" class="headerlink" title="设置Web服务"></a>设置Web服务</h1><p>Web服务器默认拒绝外网访问，需要将这个限制解除</p><ol><li>编辑 /etc/config/uhttpd</li></ol><p>将<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">option rfc1918_filter <span class="string">'1'</span></span><br></pre></td></tr></table></figure></p><p>  改为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">option rfc1918_filter <span class="string">'0'</span></span><br></pre></td></tr></table></figure></p><ol start="2"><li>重启Web服务</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/uhttpd restart</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如果你在自己的Pandorabox/openwrt/lede上安装了aria2,你或许希望在外网能够访问自己家的服务器，这时候就要用到ddns。&lt;/p&gt;
&lt;p&gt;花生壳提供的壳域名，历史悠久，便宜好用。&lt;br&gt;注册了花生壳域名之后，这篇文章教你怎样给自己的路由器设置DDNS。
      
    
    </summary>
    
    
      <category term="Pandorabox" scheme="http://leowll.com/tags/Pandorabox/"/>
    
      <category term="openwrt" scheme="http://leowll.com/tags/openwrt/"/>
    
      <category term="ddns" scheme="http://leowll.com/tags/ddns/"/>
    
      <category term="oray" scheme="http://leowll.com/tags/oray/"/>
    
  </entry>
  
  <entry>
    <title>为安装了Pandorabox的小米路由器Pro配置ipv6</title>
    <link href="http://leowll.com/2018/06/09/config-pandorabox-ipv6/"/>
    <id>http://leowll.com/2018/06/09/config-pandorabox-ipv6/</id>
    <published>2018-06-09T06:40:00.000Z</published>
    <updated>2018-06-09T08:18:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考来源： <a href="http://www.cnblogs.com/Arago/p/7765873.html" target="_blank" rel="noopener">Openwrt配置NAT6</a></p><p>假如你家的路由器是Pandorabox（或者其他openwrt，lede）的路由器，并且你家的网络支持ipv6， 那怎样设置路由器来实现网络提速呢？<br>先来看一下我家网络的提速效果：</p><p><img src="https://s1.ax1x.com/2018/06/09/Cbf4c8.md.png" height="200px" alt="speed test"></p><p>之前家里的网络速度一直徘徊在100M以下，设置了ipv6之后，一直保持在100M左右。</p><h1 id="ipv6比ipv4更快吗？"><a href="#ipv6比ipv4更快吗？" class="headerlink" title="ipv6比ipv4更快吗？"></a>ipv6比ipv4更快吗？</h1><p><a href="https://www.zhihu.com/question/19570943" target="_blank" rel="noopener">ipv6比ipv4更快吗？</a></p><blockquote><p>说 IPv6 能提高「网速」通常是指新建的 IPv6 网络通常具有更大的带宽（比如中国正在新建的 CERNET2 骨干网动辄 10Gbps、100Gbps 的连接带宽）、更好的流量控制、更少的 NAT 从而实现更高效的网络拓扑结构（IP 地址资源多从而不需要对数据包进行多次地址翻译和转发）。在这些方面 IPv6 确实是能提高「网速」的。</p></blockquote><h1 id="NAT的工作原理"><a href="#NAT的工作原理" class="headerlink" title="NAT的工作原理"></a>NAT的工作原理</h1><p>当内部网络中的一台主机想传输数据到外部网络时，它先将数据包传输到NAT路由器上，路由器检查数据包的报头，获取该数据包的源IP信息，并从它的NAT映射表中找出与该IP匹配的转换条目，用所选用的内部全局地址（全球唯一的IP地址）来替换内部局部地址，并转发数据包。<br>当外部网络对内部主机进行应答时，数据包被送到NAT路由器上，路由器接收到目的地址为内部全局地址的数据包后，它将用内部全局地址通过NAT映射表查找出内部局部地址，然后将数据包的目的地址替换成内部局部地址，并将数据包转发到内部主机。<br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Nat2.svg/300px-Nat2.svg.png" alt="nat工作原理"></p><h1 id="设置步骤"><a href="#设置步骤" class="headerlink" title="设置步骤"></a>设置步骤</h1><h2 id="查看-设置ipv6前缀"><a href="#查看-设置ipv6前缀" class="headerlink" title="查看/设置ipv6前缀"></a>查看/设置ipv6前缀</h2><p>在管理界面的网络&gt;接口画面可以看到</p><p>默认ipv6的前缀是设置好的，当然也可以自己定义一下。<br><a href="https://imgchr.com/i/CbfB6O" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/CbfB6O.md.jpg" alt="CbfB6O.md.jpg"></a></p><h2 id="设置DHCPv6"><a href="#设置DHCPv6" class="headerlink" title="设置DHCPv6"></a>设置DHCPv6</h2><p>在网络&gt;接口-LAN&gt;DHCP服务器中进行如下设置，使连接到网络的设备能自动获取ipv6地址：</p><ul><li>路由器通告服务： 服务器模式</li><li>DHCPv6服务： 服务器模式</li><li>DHCPv6模式： 无状态的+有状态的</li></ul><p><a href="https://imgchr.com/i/Cbfwp6" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/Cbfwp6.md.png" alt="Cbfwp6.md.png"></a></p><h2 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h2><p>ssh进你的路由器，执行下列命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip6tables -t nat -A POSTROUTING -o eth0.2 -j MASQUERADE</span><br></pre></td></tr></table></figure></p><p>等同于在路由器管理界面的防火墙中添加下列NAT规则</p><p><a href="https://imgchr.com/i/CbfDXD" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/CbfDXD.md.png" alt="CbfDXD.md.png"></a></p><h2 id="配置网关"><a href="#配置网关" class="headerlink" title="配置网关"></a>配置网关</h2><p>同样利用ssh，查看自己路由器的默认ipv6网关<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip -6 route | grep default</span><br></pre></td></tr></table></figure></p><p>得到的结果类似于<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default from (your ipv6) via (gateway) dev eth0.2 proto static metric 512</span><br></pre></td></tr></table></figure></p><p>(gateway)的部分就是你的默认ipv6网关</p><p>执行下列命令设置你的默认ipv6网关<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route -A inet6 add default gw &lt;your default gw&gt; dev eth0.2</span><br></pre></td></tr></table></figure></p><p>执行下列命令重启防火墙和网络使设置生效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/firewall restart</span><br><span class="line">/etc/init.d/network restart</span><br></pre></td></tr></table></figure></p><h2 id="配置开机自动设置ipv6路由默认网关"><a href="#配置开机自动设置ipv6路由默认网关" class="headerlink" title="配置开机自动设置ipv6路由默认网关"></a>配置开机自动设置ipv6路由默认网关</h2><p>上述配置在重启路由器后会失效，需要在开机的时候自动设置网关。</p><p>在/etc/hotplug.d/iface/目录下新建名字为 90-ipv6 的文件<br>修改内容为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">[ <span class="string">"<span class="variable">$ACTION</span>"</span> = ifup ] || <span class="built_in">exit</span> 0</span><br><span class="line">route -A inet6 add default gw &lt;your default gw&gt; dev eth0.2</span><br></pre></td></tr></table></figure><p>给予可执行权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x 90-ipv6</span><br></pre></td></tr></table></figure></p><h2 id="配置DNS服务器"><a href="#配置DNS服务器" class="headerlink" title="配置DNS服务器"></a>配置DNS服务器</h2><p>DNS有可能被污染 手动修改wan6的dns方法是：</p><ol><li>修改wan6-高级设置 </li><li>取消勾选对端通告的DNS服务器 </li><li>自定义为谷歌的v6dns</li></ol><p><a href="https://imgchr.com/i/Cbf01K" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/Cbf01K.md.png" alt="Cbf01K.md.png"></a></p><h2 id="测试IPv6是否正常"><a href="#测试IPv6是否正常" class="headerlink" title="测试IPv6是否正常"></a>测试IPv6是否正常</h2><p>通过 <a href="http://test-ipv6.com/" target="_blank" rel="noopener">http://test-ipv6.com/</a> </p><p>或者 <a href="http://ipv6-test.com/" target="_blank" rel="noopener">http://ipv6-test.com/</a></p><p>测试IPv6是否正常</p><p><a href="https://imgchr.com/i/Cbfsne" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2018/06/09/Cbfsne.md.jpg" alt="Cbfsne.md.jpg"></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;参考来源： &lt;a href=&quot;http://www.cnblogs.com/Arago/p/7765873.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Openwrt配置NAT6&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;假如你家的路由器是Pandorabox（或
      
    
    </summary>
    
    
      <category term="Pandorabox" scheme="http://leowll.com/tags/Pandorabox/"/>
    
      <category term="openwrt" scheme="http://leowll.com/tags/openwrt/"/>
    
      <category term="lede" scheme="http://leowll.com/tags/lede/"/>
    
      <category term="ipv6" scheme="http://leowll.com/tags/ipv6/"/>
    
      <category term="mi r3p" scheme="http://leowll.com/tags/mi-r3p/"/>
    
  </entry>
  
  <entry>
    <title>为什么Java取MD5哈希值的时候要&amp;0xff</title>
    <link href="http://leowll.com/2018/06/07/why-java-md5-0xff/"/>
    <id>http://leowll.com/2018/06/07/why-java-md5-0xff/</id>
    <published>2018-06-07T18:50:39.000Z</published>
    <updated>2018-06-08T08:26:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>想要得到字符串的MD5哈希值怎么办？<br>先来了解一下MD5哈希值的概念。</p><h2 id="MD5散列"><a href="#MD5散列" class="headerlink" title="MD5散列"></a>MD5散列</h2><p>一般128位的MD5散列被表示为32位十六进制数字。以下是一个43位长的仅ASCII字母列的MD5散列：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MD5(<span class="string">"The quick brown fox jumps over the lazy dog"</span>)</span><br><span class="line">= <span class="number">9e107</span>d9d372bb6826bd81d3542a419d6</span><br></pre></td></tr></table></figure></p><p>即使在原文中作一个小变化（比如用c取代d）其散列也会发生巨大的变化：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MD5(<span class="string">"The quick brown fox jumps over the lazy cog"</span>)</span><br><span class="line">= <span class="number">1055</span>d3e698d289f2af8663725127bd4b</span><br></pre></td></tr></table></figure></p><p>也就是说，给你一串字符串，你要把它转换成固定长度的散列。</p><p>##用Java来实现MD5哈希值<br>Java中可以这样实现:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">String password = <span class="string">"123456"</span>;</span><br><span class="line"></span><br><span class="line">   MessageDigest md = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">   md.update(password.getBytes());</span><br><span class="line">   <span class="keyword">byte</span> byteData[] = md.digest();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//convert the byte to hex format method 1</span></span><br><span class="line">   StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; byteData.length; i++) &#123;</span><br><span class="line">    sb.append(Integer.toString((byteData[i] &amp; <span class="number">0xff</span>) + <span class="number">0x100</span>, <span class="number">16</span>).substring(<span class="number">1</span>));</span><br><span class="line">   &#125;</span><br><span class="line">   System.out.println(<span class="string">"Digest(in hex format):: "</span> + sb.toString());</span><br></pre></td></tr></table></figure></p><h2 id="byte数值转换为int数值时的注意事项"><a href="#byte数值转换为int数值时的注意事项" class="headerlink" title="byte数值转换为int数值时的注意事项"></a>byte数值转换为int数值时的注意事项</h2><p>那么问题来了，下面这行代码做的是啥？<br><code>Integer.toString((byteData[i] &amp; 0xff) + 0x100, 16).substring(1)</code><br>这行语句其实是将byteData中的byte类型的数据转换成十六进制的数据进行表示。<br>为什么这么复杂？<br>是因为要考虑到byteData中的负数。</p><p>考虑一下下面这段代码，试图将byte类型表示为16进制形式的字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testByteInt</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">byte</span> a = <span class="number">127</span>;</span><br><span class="line">print(a);</span><br><span class="line"><span class="keyword">byte</span> b = -<span class="number">127</span>;</span><br><span class="line">print(b);</span><br><span class="line"><span class="keyword">byte</span> c = <span class="number">2</span>;</span><br><span class="line">print(c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">byte</span> b)</span> </span>&#123;</span><br><span class="line">System.out.println(Integer.toBinaryString(b));</span><br><span class="line">System.out.println(Integer.toBinaryString(b &amp; <span class="number">0xff</span>));</span><br><span class="line">System.out.println(Integer.toHexString(b));</span><br><span class="line">System.out.println(Integer.toHexString(b &amp; <span class="number">0xff</span>));</span><br><span class="line">System.out.println(Integer.toString(b, <span class="number">16</span>));</span><br><span class="line">System.out.println(Integer.toString(b &amp; <span class="number">0xff</span>, <span class="number">16</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1111111</span><br><span class="line">1111111</span><br><span class="line">7f</span><br><span class="line">7f</span><br><span class="line">7f</span><br><span class="line">7f</span><br><span class="line">11111111111111111111111110000001</span><br><span class="line">10000001</span><br><span class="line">ffffff81</span><br><span class="line">81</span><br><span class="line">-7f</span><br><span class="line">81</span><br><span class="line">10</span><br><span class="line">10</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">2</span><br></pre></td></tr></table></figure></p><p>从输出结果可以看出几个问题。</p><ul><li>String的几个函数接收byte类型的参数时自动将其转换为int类型</li><li>int类型的负数<code>-127</code>用2进制数据来表示的时候，会用符号位补全，变成<code>11111111111111111111111110000001</code>, 而这个2进制的数据再用16进制来表示的时候却成了<code>ffffff81</code>，与<code>-127</code>的16进制表示<strong>不一致</strong>。</li><li>负数的十六进制表现形式例如<code>-7f</code>不符合哈希值的要求。哈希值中不能带有负号。所以需要将其转换一下。</li><li>比较小的数值，例如<code>2</code>，转换成的16进制字符串也是<code>2</code>，不符合哈希值的长度要求。哈希值要求每个byte用2个16进制的字符来表示。</li></ul><p>要解决上面两个问题，前面的java程序给出的答案是：</p><ul><li>用<code>&amp; 0xff</code>来对byte数值进行补零扩展</li><li>用<code>+ 0x100</code>来保证每个数转换成16进制后会得到3个字符</li><li>用<code>.subString(1)</code>来去掉3个字符的第一个字符</li></ul><p>这样就能得到2个16进制的字符了。<br>循环一遍，就能得到相应的MD5哈希字符串了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;想要得到字符串的MD5哈希值怎么办？&lt;br&gt;先来了解一下MD5哈希值的概念。&lt;/p&gt;
&lt;h2 id=&quot;MD5散列&quot;&gt;&lt;a href=&quot;#MD5散列&quot; class=&quot;headerlink&quot; title=&quot;MD5散列&quot;&gt;&lt;/a&gt;MD5散列&lt;/h2&gt;&lt;p&gt;一般128位的MD5散列
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="java" scheme="http://leowll.com/tags/java/"/>
    
      <category term="md5" scheme="http://leowll.com/tags/md5/"/>
    
      <category term="hash" scheme="http://leowll.com/tags/hash/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Generate 没有反应的原因</title>
    <link href="http://leowll.com/2018/06/06/hexo-generate-no-response/"/>
    <id>http://leowll.com/2018/06/06/hexo-generate-no-response/</id>
    <published>2018-06-06T15:05:00.000Z</published>
    <updated>2018-06-06T15:09:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>在hexo执行下列命令时，没有看到生成的结果，只看到了一个kill之类的中断语句。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure></p><p>原因很可能是你的服务器（vps）swap不足。<br>通过执行下列命令可以增加swap内存。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo dd <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1024 count=1024k</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line">sudo swapon /swapfile</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在hexo执行下列命令时，没有看到生成的结果，只看到了一个kill之类的中断语句。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="hexo" scheme="http://leowll.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>理解Spring中的DI和AOP</title>
    <link href="http://leowll.com/2018/05/10/understand-spring-di-aop/"/>
    <id>http://leowll.com/2018/05/10/understand-spring-di-aop/</id>
    <published>2018-05-10T09:55:25.000Z</published>
    <updated>2018-06-06T13:49:12.784Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题的提出"><a href="#问题的提出" class="headerlink" title="问题的提出"></a><strong>问题的提出</strong></h1><p>Spring中的依赖注入（DI)为何而生？<br> 下面这篇日语文章提到，所有的Web应用都需要考虑到下面三个问题。[] <a href="http://penguinlabo.wp.xdomain.jp/understandspringmvc/" target="_blank" rel="noopener">http://penguinlabo.wp.xdomain.jp/understandspringmvc/</a></p><ol><li>对象的生命周期问题。<br>假设你用Servlet来接收用户的访问请求，有一个用户需要访问一个页面，你就需要一个线程来负责处理这个请求，并调用某个业务逻辑（比如调用一个UserService的实例）。如果处理不当，每新增一个用户就实例化一个业务逻辑（new一个UserService的实例），随着访问用户的增多，就会给系统带来大量垃圾回收负担，以及内存消耗的问题。为了防止这种情况发生，就需要把业务逻辑的部分设计为Singleton的，这样就不会每次都新增一个实例</li><li>松耦合问题。<br>为了实现Web程序中的松耦合，即让一个类与另一个类不是那么的紧密结合，通常需要接口（Interface）来实现。但是单存的利用Interface并不能实现松耦合。还需要利用一些技巧，比如Factory Method等设计模式。 </li><li>技术细节的隐藏。<br>当你写一个User或者SalesOrder类的时候，你希望专注于自己的业务逻辑，比如创建用户，删除用户，创建订单，删除订单这些具体的业务。如果你在这些类中再加上访问记录（log）处理，就会明显的影响你程序的可读性。因为本质上log处理和你的业务逻辑没有什么联系，两者混杂在一起就会让人看起来比较头大。还有一些异常处理类的逻辑也会产生同样的问题。你怎样才能把这些和真正的业务逻辑无关的逻辑分离出去？</li></ol><h1 id="问题的回答"><a href="#问题的回答" class="headerlink" title="问题的回答"></a>问题的回答</h1><p>Spring给出的解决方案是这样的。<br>1）对象的生命周期问题。=&gt;DI<br>2）松耦合问题。 =&gt; DI<br>3）技术细节的隐藏。=&gt;AOP </p><p>首先Spring是怎么实现DI的呢，是通过DI Container来实现的。<br>在没有使用DI的Web应用中，Controller用到Service的时候，会生成（new）一个，Service用到DAO的时候，也是同样的生成（new）一个。 <img src="http://65.49.230.2/wordpress/wp-content/uploads/2018/06/no-di-300x187.jpg" alt=""> 而使用了DI的Spring，则将实例化的工作全部交给了DI Container去做。 Controller中仅仅声明了Service接口的一个属性，具体的实现（new）没有去做，同样Service中也只是声明了一个DAO接口的一个属性，也没有去实现（new）。当需要实例的时候，就让DI Container根据配置去找到合适的类去实例化相应的接口属性。 <img src="http://65.49.230.2/wordpress/wp-content/uploads/2018/06/DI-300x186.png" alt=""> 而用Spring写成的Web程序，其处理顺序可以用下图来表示 <img src="http://65.49.230.2/wordpress/wp-content/uploads/2018/06/Spring-flow-300x195.png" alt=""></p><ol><li>Dispatcher Servlet接收用户访问请求</li><li>Dispatcher Servlet利用HandlerMapping取得URL所对应的Controller对象</li><li>Controller来实行业务逻辑，调用Service对象和DAO对象得到业务数据，并把数据放到Model中。并返回一个View的名字，希望把数据显示到该View上。</li><li>Dispatcher Servlet得到View的名字后，调用View Resolver来得到相应的View对象。</li><li>Dispatcher Servlet把View对象生成为一个画面（View），画面包含Model对象中的数据，然后把这个View返回给用户(response)。用户的浏览器把这个画面呈献给用户。</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题的提出&quot;&gt;&lt;a href=&quot;#问题的提出&quot; class=&quot;headerlink&quot; title=&quot;问题的提出&quot;&gt;&lt;/a&gt;&lt;strong&gt;问题的提出&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;Spring中的依赖注入（DI)为何而生？&lt;br&gt; 下面这篇日语文章提到，所有的W
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Java" scheme="http://leowll.com/tags/Java/"/>
    
      <category term="Spring" scheme="http://leowll.com/tags/Spring/"/>
    
      <category term="AOP" scheme="http://leowll.com/tags/AOP/"/>
    
      <category term="DI" scheme="http://leowll.com/tags/DI/"/>
    
      <category term="设计模式" scheme="http://leowll.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>我对Javascript中的闭包Closure的理解</title>
    <link href="http://leowll.com/2017/02/20/my-understandng-of-javascript-closure/"/>
    <id>http://leowll.com/2017/02/20/my-understandng-of-javascript-closure/</id>
    <published>2017-02-21T03:25:27.000Z</published>
    <updated>2018-06-06T14:39:37.880Z</updated>
    
    <content type="html"><![CDATA[<p>怎样理解 Javascript Closure 也就是闭包的概念，想必很多人在为此头疼。 笔者先后参考了下面这些资料 </p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures" target="_blank" rel="noopener">MDN Javascript Closure</a> </li><li><a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="noopener">阮一峰的博客</a> </li><li><a href="http://www.cnblogs.com/frankfang/archive/2011/08/03/2125663.html" target="_blank" rel="noopener">Frank Fang的博客</a> </li></ul><p>作者们都声称自己搞懂了闭包的概念，可自己还是看的云里雾里。 直到笔者看到下面这篇文章，才开始真正理解闭包的概念和应用场景。 Jonathan D. Johnson的博客 <a href="http://jondavidjohn.com/javascript-closure-explained-using-events/" target="_blank" rel="noopener">http://jondavidjohn.com/javascript-closure-explained-using-events/</a> 下面我试着把这篇文章边翻译边把自己的理解写出来。 先看一下下面这段程序， 效果：在第3次按下button的时候显示”Third time’s the charm”的消息框。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// declare counter outside event handler's scope</span></span><br><span class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"button"</span>);</span><br><span class="line"></span><br><span class="line">element.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// increment outside counter</span></span><br><span class="line">    counter++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (counter === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="comment">// do something every third time</span></span><br><span class="line">        alert(<span class="string">"Third time's the charm!"</span>);</span><br><span class="line">        <span class="comment">// reset counter</span></span><br><span class="line">        counter = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>程序中声明了一个全局变量counter,每次按下button都会唤起程序，从而让counter++ 如果你只在自己的网页中执行一次的话，这么写也无所谓，但是如果你想在其他地方复用的话， 最好还是把这段程序封装成单独的一个函数。 这时问题就来了，你要每次都声明一个外部的全局变量counter吗？很明显这种做法太笨拙。 于是closure的作用就发挥出来了。 如果你看过了MDN的解释，就会知道closure其实是这样一种机制，</p><blockquote><p>函数可以访问它被创建时所处的作用域中的对象（Object）。</p></blockquote><p>于是上面那段程序利用闭包可以优化成下面这种形式：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"button1"</span> <span class="attr">value</span>=<span class="string">"button1"</span> <span class="attr">class</span>=<span class="string">"button"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"button2"</span> <span class="attr">value</span>=<span class="string">"button2"</span> <span class="attr">class</span>=<span class="string">"button"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> myClosureFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// init the count to 0</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> count = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">//count</span></span></span><br><span class="line"><span class="undefined">            count++;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (count === <span class="number">3</span>) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// do something every third time</span></span></span><br><span class="line"><span class="javascript">                alert(<span class="string">"Third time's the charm!"</span>);</span></span><br><span class="line"><span class="javascript">                <span class="comment">//reset counter</span></span></span><br><span class="line"><span class="undefined">                count = 0;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> element1 = <span class="built_in">document</span>.getElementById(<span class="string">"button1"</span>);</span></span><br><span class="line"><span class="undefined">    element1.onclick = myClosureFunc();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> element2 = <span class="built_in">document</span>.getElementById(<span class="string">"button2"</span>);</span></span><br><span class="line"><span class="undefined">    element2.onclick = myClosureFunc();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>  counter的位置移到了event handler函数的内部，而函数的返回值为一个闭包。 按照上面的概念，myClosureFunc中的闭包可以访问它创建时所处的作用域(scope), 于是它就可以访问自己的counter，而这个counter是<strong>相对</strong>全局的，也就是说，在element1被按下的过程中，这个counter是共有的。 而element1和element2中的counter又是<strong>相对独立</strong>的。 怎么样，有没有帮你理解closure在作用域这个概念里所起的作用？</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;怎样理解 Javascript Closure 也就是闭包的概念，想必很多人在为此头疼。 笔者先后参考了下面这些资料 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/JavaScript
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Javascript" scheme="http://leowll.com/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>[SAPUI5 Tutorial Trouble Shooting] Test Suite and Automated Testing Step10</title>
    <link href="http://leowll.com/2017/02/15/sapui5-qunit-404-not-found/"/>
    <id>http://leowll.com/2017/02/15/sapui5-qunit-404-not-found/</id>
    <published>2017-02-15T05:37:52.000Z</published>
    <updated>2018-06-06T13:52:51.110Z</updated>
    
    <content type="html"><![CDATA[<p>如果你在进行[SAPUI5 Tutorial] Test Suite and Automated Testing Step10 时遇到过 SAPUI5 QUnit 404 not found 问题， /resources/sap/ui/qunit/qunit-redirect.js 404 not found 这篇文章将帮你找到解决方法。 正如Tutorial一开始写的<a href="https://sapui5.netweaver.ondemand.com/sdk/index.html#docs/guide/8b49fc198bf04b2d9800fc37fecbb218.html" target="_blank" rel="noopener">那样</a>，</p><blockquote><p>If you are running the tutorial in SAP Web IDE, you will have to configure the project descriptor neo-app.json. In this descriptor file, the path to the resources is already configured. Other development environments might need the resources to be copied to the server. Alternatively, you can use the CDN version of <a href="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js" target="_blank" rel="noopener">https://sapui5.hana.ondemand.com/resources/sap-ui-core.js</a>.</p></blockquote><p>也就是说，如果你使用的是Web IDE,而你又是copy的Tutorial中给出的code，你还需要配置项目的neo-app.json文件让项目找到resources系列的文件。 If you are using web IDE and copied the code from the sample, you may aslo need to set up the neo-app.json file to let the project find the resource folder. 具体配置如下所示，其实就是简单复制一下从头开始新建的项目中的neo-app.json文件。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"welcomeFile"</span>: <span class="string">"/webapp/test/test.html"</span>,</span><br><span class="line">  <span class="attr">"routes"</span>: \[</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"/resources"</span>,</span><br><span class="line">      <span class="attr">"target"</span>: &#123;</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"service"</span>,</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"sapui5"</span>,</span><br><span class="line">        <span class="attr">"entryPath"</span>: <span class="string">"/resources"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"description"</span>: <span class="string">"SAPUI5 Resources"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"/test-resources"</span>,</span><br><span class="line">      <span class="attr">"target"</span>: &#123;</span><br><span class="line">        <span class="attr">"type"</span>: <span class="string">"service"</span>,</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"sapui5"</span>,</span><br><span class="line">        <span class="attr">"entryPath"</span>: <span class="string">"/test-resources"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"description"</span>: <span class="string">"SAPUI5 Test Resources"</span></span><br><span class="line">    &#125;</span><br><span class="line">  \],</span><br><span class="line">  <span class="attr">"sendWelcomeFileRedirect"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如果你在进行[SAPUI5 Tutorial] Test Suite and Automated Testing Step10 时遇到过 SAPUI5 QUnit 404 not found 问题， /resources/sap/ui/qunit/qunit-redirec
      
    
    </summary>
    
      <category term="SAP" scheme="http://leowll.com/categories/SAP/"/>
    
      <category term="技术" scheme="http://leowll.com/categories/SAP/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="qunit" scheme="http://leowll.com/tags/qunit/"/>
    
      <category term="sapui5" scheme="http://leowll.com/tags/sapui5/"/>
    
  </entry>
  
  <entry>
    <title>在sap hybris的accelerator中添加hybris cms组件(hybris cms component)的方法</title>
    <link href="http://leowll.com/2016/11/14/create-new-hybris-cms-component-in-accelerator/"/>
    <id>http://leowll.com/2016/11/14/create-new-hybris-cms-component-in-accelerator/</id>
    <published>2016-11-15T00:43:50.000Z</published>
    <updated>2018-06-06T13:53:57.218Z</updated>
    
    <content type="html"><![CDATA[<p>在hybris的accelerator中新建CMS组件(<strong>hybris cms component</strong>)的步骤包括： *注意：hybris addon中的步骤有所不同，将在另一篇文章中记述。</p><ol><li>自定义hybris item，在extension的items.xml文件中定义，类似于任何其他hybris item。</li><li>一个继承AbstractCMSComponentController的Spring MVC控制器，或使用DefaultCMSComponentController。</li><li>用于在页面上呈现组件的JSP，根据需要使用HTML，CSS和Tag Libraries。</li></ol><p>可以通过XML配置为组件自定义hybris WCMS Cockpit：</p><ol><li>editorArea_typeName.xml：WCMS Cockpit编辑器区域的配置文件。</li><li>contentEditor_typeName.xml：用于LiveEdit模式和联机编辑的配置文件</li><li>wizardConfig_typeName.xml：如果通过向导对话框添加组件，则通过此文件进行向导配置。</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在hybris的accelerator中新建CMS组件(&lt;strong&gt;hybris cms component&lt;/strong&gt;)的步骤包括： *注意：hybris addon中的步骤有所不同，将在另一篇文章中记述。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;自定义hybris item
      
    
    </summary>
    
      <category term="SAP" scheme="http://leowll.com/categories/SAP/"/>
    
      <category term="技术" scheme="http://leowll.com/categories/SAP/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="cms component" scheme="http://leowll.com/tags/cms-component/"/>
    
      <category term="hybris cms component" scheme="http://leowll.com/tags/hybris-cms-component/"/>
    
      <category term="sap hybris" scheme="http://leowll.com/tags/sap-hybris/"/>
    
  </entry>
  
  <entry>
    <title>在SAP hybris中实行单体测试(Unit Test)的注意事项</title>
    <link href="http://leowll.com/2016/10/28/sap-hybris-unit-test-note/"/>
    <id>http://leowll.com/2016/10/28/sap-hybris-unit-test-note/</id>
    <published>2016-10-28T08:45:22.000Z</published>
    <updated>2018-06-06T09:25:26.813Z</updated>
    
    <content type="html"><![CDATA[<p>在SAP hybris的单体测试中，出现如下错误信息：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ERROR \[main\] (junit) \[FlexibleSearch\] Flexiblesearch error: could not translate value expression 'session.catalogversions'</span><br><span class="line">ERROR \[main\] (junit) \[FlexibleSearch\] query was 'SELECT &#123;cat.pk&#125; FROM &#123;Category AS cat&#125; WHERE NOT EXISTS (&#123; &#123;SELECT &#123;pk&#125; FROM &#123;CategoryCategoryRelation AS rel JOIN Category AS super ON &#123;rel.source&#125;=&#123;super.PK&#125; &#125; WHERE &#123;rel:target&#125;=&#123;cat.pk&#125; AND &#123;super.catalogVersion&#125;=&#123;cat.catalogVersion&#125; &#125;&#125;) AND &#123;cat.catalogVersion&#125; = ?catalogVersion'</span><br><span class="line">ERROR \[main\] (junit) \[FlexibleSearch\] translated query was: SELECT  item\_t0.PK  FROM junit\_categories item\_t0 WHERE (NOT EXISTS (SELECT  item\_t1.PK  FROM junit\_cat2catrel item\_t1 JOIN junit\_categories item\_t2 ON  item\_t1.SourcePK = item\_t2.PK  WHERE ( item\_t1.TargetPK = item\_t0.PK  AND  item\_t2.p\_catalogversion = item\_t0.p\_catalogversion ) AND ((item\_t1.TypePkString=?  AND item\_t2.TypePkString IN  (?,?,?,?)  AND (( item\_t2.p\_catalogversion  IN (?))) ))) AND  item\_t0.p\_catalogversion  = ?) AND (item\_t0.TypePkString IN  (?,?,?,?)  AND (( item\_t0.p_catalogversion  IN (?))) )</span><br><span class="line">ERROR \[main\] (junit) \[LogRunListener\] Test method testCategoryNav(org.training.renderer.CategoryNavComponentRendererTest) failed!!</span><br><span class="line">de.hybris.platform.servicelayer.search.exceptions.FlexibleSearchException: could not translate value expression 'session.catalogversions'</span><br></pre></td></tr></table></figure></p><p>Java代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> org.training.renderer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.hybris.platform.catalog.CatalogVersionService;</span><br><span class="line"><span class="keyword">import</span> de.hybris.platform.catalog.model.CatalogVersionModel;</span><br><span class="line"><span class="keyword">import</span> de.hybris.platform.category.CategoryService;</span><br><span class="line"><span class="keyword">import</span> de.hybris.platform.category.model.CategoryModel;</span><br><span class="line"><span class="keyword">import</span> de.hybris.platform.servicelayer.ServicelayerTransactionalTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/\*\*</span><br><span class="line"> \* <span class="meta">@author</span> lwang</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryNavComponentRendererTest</span> <span class="keyword">extends</span> <span class="title">ServicelayerTransactionalTest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span>(name = <span class="string">"categoryService"</span>)</span><br><span class="line"><span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span>(name = <span class="string">"catalogVersionService"</span>)</span><br><span class="line"><span class="keyword">private</span> CatalogVersionService catalogVersionService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCategoryNav</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">final</span> CatalogVersionModel catalogVersion = catalogVersionService.getCatalogVersion(<span class="string">"uaProductCatalog"</span>, <span class="string">"Online"</span>);</span><br><span class="line">Assert.assertNotNull(catalogVersion);</span><br><span class="line"><span class="keyword">final</span> Collection&lt;CategoryModel&gt; categoryList = categoryService.getRootCategoriesForCatalogVersion(catalogVersion);</span><br><span class="line">Assert.assertNotNull(categoryList);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>之所以会出现错误，是因为程序没有加载hybris框架通常需要的一些环境变量。 在测试用例中加入如下代码可以解决问题。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">createCoreData();</span><br><span class="line">createDefaultCatalog();</span><br><span class="line">createHardwareCatalog();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在SAP hybris的单体测试中，出现如下错误信息：&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span clas
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="sap hybris" scheme="http://leowll.com/tags/sap-hybris/"/>
    
      <category term="sap hybris unit test" scheme="http://leowll.com/tags/sap-hybris-unit-test/"/>
    
  </entry>
  
  <entry>
    <title>sap hybris在新建自定义cms component时的注意事项</title>
    <link href="http://leowll.com/2016/10/25/sap-hybris-cms-component-notes/"/>
    <id>http://leowll.com/2016/10/25/sap-hybris-cms-component-notes/</id>
    <published>2016-10-26T02:06:57.000Z</published>
    <updated>2018-06-06T13:55:53.959Z</updated>
    
    <content type="html"><![CDATA[<p>在SAP hybris中添加自定义的CMS Component,需要注意以下几点： 参考链接:<a href="https://wiki.hybris.com/pages/viewpage.action?pageId=294094319" target="_blank" rel="noopener"> https://wiki.hybris.com/pages/viewpage.action?pageId=294094319</a></p><ol><li>在addon中添加，可免去对accelerator的修改</li><li>在/<addon-name>/resources/<addon-name>/web/spring/<addon-name>-web-spring.xml中添加renderer和rendererMapping的定义</addon-name></addon-name></addon-name></li><li>使用ant命令安装addon</li></ol><p>/<addon-name>-web-spring.xml的代码示例如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"yourComponentRenderer"</span> <span class="attr">class</span>=<span class="string">"org.training.renderer.yourComponentRenderer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeService"</span> <span class="attr">ref</span>=<span class="string">"typeService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"uiExperienceService"</span> <span class="attr">ref</span>=<span class="string">"defaultUiExperienceService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cmsComponentService"</span> <span class="attr">ref</span>=<span class="string">"cmsComponentService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"modelService"</span> <span class="attr">ref</span>=<span class="string">"modelService"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"uiExperienceViewPrefixMap"</span> <span class="attr">ref</span>=<span class="string">"uiExperienceViewPrefixMap"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"unknownUiExperiencePrefix"</span> <span class="attr">value</span>=<span class="string">"desktop"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"yourComponentRendererMapping"</span> <span class="attr">parent</span>=<span class="string">"addonCmsComponentRendererMapping"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeCode"</span> <span class="attr">value</span>=<span class="string">"yourComponent"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">ref</span>=<span class="string">"yourComponentRenderer"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></addon-name></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在SAP hybris中添加自定义的CMS Component,需要注意以下几点： 参考链接:&lt;a href=&quot;https://wiki.hybris.com/pages/viewpage.action?pageId=294094319&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="cms component" scheme="http://leowll.com/tags/cms-component/"/>
    
      <category term="sap hybris" scheme="http://leowll.com/tags/sap-hybris/"/>
    
  </entry>
  
  <entry>
    <title>Sony 面经</title>
    <link href="http://leowll.com/2016/09/27/sony-interview-questions/"/>
    <id>http://leowll.com/2016/09/27/sony-interview-questions/</id>
    <published>2016-09-28T02:12:57.000Z</published>
    <updated>2018-06-06T05:49:00.140Z</updated>
    
    <content type="html"><![CDATA[<p>Sony面试的一些问题记录一下。   时间:9月26日 地点：品川本社 面试官：4人 问题：</p><ul><li>自我介绍</li><li>简历细节的确认</li><li>离职的动机</li><li>来日本工作的动机</li><li>介绍一下迄今为止所经历的项目中的成功和失败经验</li><li>你自己的卖点(Sales Point)是什么</li><li>对这个岗位的理解</li><li>业余时间做过什么项目</li><li>有什么问题<ul><li>岗位具体的工作内容是什么</li><li>同样年龄段的人都是怎样的工作风格</li><li>该岗位对英语作了一些具体要求，实际工作中和海外的团队有何种交流合作</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Sony面试的一些问题记录一下。   时间:9月26日 地点：品川本社 面试官：4人 问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自我介绍&lt;/li&gt;
&lt;li&gt;简历细节的确认&lt;/li&gt;
&lt;li&gt;离职的动机&lt;/li&gt;
&lt;li&gt;来日本工作的动机&lt;/li&gt;
&lt;li&gt;介绍一下迄今为止所经历的项
      
    
    </summary>
    
      <category term="职业" scheme="http://leowll.com/categories/%E8%81%8C%E4%B8%9A/"/>
    
    
      <category term="sony interview questions" scheme="http://leowll.com/tags/sony-interview-questions/"/>
    
  </entry>
  
  <entry>
    <title>有了uwsgi为什么还需要nginx</title>
    <link href="http://leowll.com/2015/11/07/why-need-nginx-with-uwsgi/"/>
    <id>http://leowll.com/2015/11/07/why-need-nginx-with-uwsgi/</id>
    <published>2015-11-07T11:13:59.000Z</published>
    <updated>2018-06-06T15:33:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ngix存在的意义在哪里？"><a href="#ngix存在的意义在哪里？" class="headerlink" title="ngix存在的意义在哪里？"></a>ngix存在的意义在哪里？</h2><p>在python的web开发中，我用flask框架写了一个小程序，部署的时候，我用到了uwsgi来做容器。<br>在学习uwsgi部署的过程中，另一个关键词nginx频繁的跳出来。这两者通常是成对出现的。<br>你有没有和我一样的困惑，为什么有了uwsgi我们还需要nginx?<br>我是说，既然uwsgi能够展现你想要的内容，那nginx存在的意义在哪里？<br>首先，nginx是一个HTTP 服务器。如果你是学Java出身的，说到HTTP服务器你应该会想到Apache。<br>类似的uwsgi可以比喻为tomcat。 nginx官方网站上给出的一张图片很好的揭示了nginx的角色。<br><img src="https://farm1.staticflickr.com/751/22845441965_8ca93b385a_z.jpg" alt="architecture-nginx"></p><h2 id="ngix的主要功能"><a href="#ngix的主要功能" class="headerlink" title="ngix的主要功能"></a>ngix的主要功能</h2><p>我所理解的nginx的主要功能，有以下几个部分：</p><ul><li>nginx处理<strong>静态内容请求更专业、快速</strong>。</li><li>nginx可以<strong>缓存请求</strong>。如果让uwsgi来直接接受请求的话，uwsgi需要花费大量的时间来等待request，这本身对web应用所在的主机是很大的资源浪费。</li><li><strong>分发请求</strong>。假如你有好几个web应用，分布在不同的主机上，nginx可以把请求分发到各自的web应用来进行处理。这一特点是nginx可以用来做负载均衡器。</li><li>相比web容器，nginx的<strong>漏洞更少更安全</strong>。</li><li>nginx可以更好的处理<strong>HTTPS</strong>。</li><li>nginx有<strong>网关</strong>（gateway）的作用，可以过滤访问IP。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ngix存在的意义在哪里？&quot;&gt;&lt;a href=&quot;#ngix存在的意义在哪里？&quot; class=&quot;headerlink&quot; title=&quot;ngix存在的意义在哪里？&quot;&gt;&lt;/a&gt;ngix存在的意义在哪里？&lt;/h2&gt;&lt;p&gt;在python的web开发中，我用flask框架写了
      
    
    </summary>
    
      <category term="技术" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="知识" scheme="http://leowll.com/categories/%E6%8A%80%E6%9C%AF/%E7%9F%A5%E8%AF%86/"/>
    
    
      <category term="web开发" scheme="http://leowll.com/tags/web%E5%BC%80%E5%8F%91/"/>
    
      <category term="load balance" scheme="http://leowll.com/tags/load-balance/"/>
    
      <category term="nginx" scheme="http://leowll.com/tags/nginx/"/>
    
      <category term="uwsgi" scheme="http://leowll.com/tags/uwsgi/"/>
    
      <category term="uwsgi nginx" scheme="http://leowll.com/tags/uwsgi-nginx/"/>
    
      <category term="负载均衡" scheme="http://leowll.com/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
  </entry>
  
</feed>
